# iotop

## 简介

简单的 I/O 监视器，类似 top

iotop 监视 Linux 内核（需要 2.6.20 或更高版本）输出的 I/O 使用信息，并显示系统上进程或线程当前 I/O 使用情况的表格。 至少需要在 Linux 内核构建配置中启用 CONFIG_TASK_DELAY_ACCT 和 CONFIG_TASK_IO_ACCOUNTING 选项，这些选项取决于 CONFIG_TASKSTATS。

iotop 显示采样期间每个进程/线程读取和写入的 I/O 带宽列。 它还显示线程/进程在换入和等待 I/O 时花费的时间百分比。 对于每个进程，都会显示其 I/O 优先级（类/级别）。 此外，在采样期间读取和写入的总 I/O 带宽显示在界面顶部。

```
iotop [OPTIONS]
```

## 命令

进入 iotop 后，可以通过按键命令操作显示信息

<style>
table th:first-of-type {
    width: 28%;
}
</style>

| 命令                     | 说明                                                          |
| :----------------------- | :------------------------------------------------------------ |
| Left Arrow / Right Arrow | 切换排序的列                                                  |
| r                        | 切换当前列升序或降序                                          |
| o                        | 切换是否只显示有 I/O 操作的进程                               |
| p                        | 切换是否只显示进程不显示线程                                  |
| a                        | 显示切换累计的读写量统计（自打开 iotop 以来）或实时的读写数据 |
| q                        | 退出 iotop                                                    |
| i                        | 更改进程或线程的优先级                                        |

## 选项

| 选项                 | 说明                                                                                                       |
| :------------------- | :--------------------------------------------------------------------------------------------------------- |
| -o, --only           | 只显示正在指向 I/O 操作的进程或线程                                                                        |
| -b, --batch          | 开启非交互模式，对于记录 I/O 使用情况很有用                                                                |
| -n NUM, --iter=NUM   | 设置推出前迭代的次数，配合非交互模式使用                                                                   |
| -d SEC, --delay=SEC  | 以秒为单位设置迭代之间的延迟（默认为 1 秒）。接受非整数值，例如 1.1 秒                                     |
| -p PID, --pid=PID    | 要监视的进程/线程列表（默认情况下显示全部）                                                                |
| -u USER, --user=USER | 要监控的用户列表（默认全部用户）                                                                           |
| -P, --processes      | 只显示进程的 I/O （默认显示全部线程）                                                                      |
| -a, --accumulated    | 显示累积的 I/O 而不是带宽。在此模式下，iotop 显示自 iotop 启动以来已完成的 I/O 进程的数量。                |
| -k, --kilobytes      | 以千字节为单位显示（KB），而不是自动调整显示单位                                                           |
| -t, --time           | 在每一行都添加一个时间戳，配合非交互模式使用                                                               |
| -q, --quiet          | 显示某些标题行显示（`-q`列表只在首次迭代输出，`-qq`不输出列名，`-qqq`不输出 I/O 摘要），配合非交互模式使用 |
| --version            | 显示版本                                                                                                   |
| -h, --help           | 显示使用帮助                                                                                               |

## 命令示例

1. 显示指定进程的 I/O 操作并记录到文件中，记录 10 次

   ```bash
   iotop -b -n 10 -P -p 9527 | tee /opt/record.iotop
   ```

2. 显示指定用户的进程 I/O 信息，间隔 3 秒刷新一次

   ```bash
   iotop -d 3 -u jack -P
   ```

Last Modified 2022-02-25
